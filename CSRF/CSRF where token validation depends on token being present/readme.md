## CSRF where token validation depends on token being present

<img width="886" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/856829e9-426a-458d-9ecb-bcc3bc7c5ada">

## Solutions:

<img width="1439" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/b5193b11-5047-40d1-8880-ea06f2f908c5">

<img width="1349" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/00c2fc01-8e40-493f-8acc-5af360c48c3b">

Post request can change the email only an extra parameter we can remove


<img width="1424" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/64ad633a-b045-42cf-9756-f75041e4c4d4">

<img width="1439" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/c6318d38-3357-4a25-a313-343cb70c2d23">

Upload it to an exploit server on portswigger


<img width="1439" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/1fb53d3e-3d95-4e5a-80ce-6c772691739f">

<img width="1429" alt="image" src="https://github.com/SantoshKumarP1412/PortSwigger/assets/140537888/48008545-d22f-40e0-b396-1eeb7cc91d36">
